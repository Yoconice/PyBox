# 文件序号倒序重命名工具

一款适用于 Windows 系统的 Python 小程序，支持对指定文件夹中带序号前缀的文件进行智能重命名，核心功能包括「非连续序号精准反转」「基准值累加」「可配置分隔符」等，灵活适配多种序号格式。

## 🌟 核心功能



1. **序号格式智能识别**：自动匹配「数字 + 分隔符 + 内容」格式的文件（如 `1、测试.txt`、`2. 文档.docx`、`3 图片.png`）

2. **非连续序号精准反转**：支持 1、2、3、8、9 等非连续序号，反转后保留真实序号（如 9、8、3、2、1）

3. **基准值累加功能**：新序号在基准常量基础上累加（如基准 0 时，9→9、8→8...）

4. **全配置化设计**：分隔符、补位位数、连接符等均可自定义，无需修改核心代码

5. **安全防护机制**：自动避免文件覆盖，捕获异常防止程序崩溃，仅处理文件不影响文件夹

## 📋 环境要求



* 操作系统：Windows 7/10/11

* Python 版本：3.6 及以上

* 依赖库：无额外依赖（使用 Python 标准库 `os`、`re`）

## ⚙️ 配置说明

程序顶部提供可配置常量，直接修改即可适配需求：



| 常量名             | 类型  | 默认值               | 说明                                                       |
| --------------- | --- | ----------------- | -------------------------------------------------------- |
| `TARGET_FOLDER` | 字符串 | `r"H:\Tes"`       | 目标文件夹路径（Windows 路径需加 `r` 前缀，如 `r"C:\Users\XXX\Desktop"`） |
| `SERIAL_PAD`    | 整数  | `3`               | 序号补位位数（3=001、002；2=01、02；1=1、2）                          |
| `CONNECTOR`     | 字符串 | `". "`            | 序号与原内容的连接符（可设为 `-`、`_` 或空字符串）                            |
| `PREFIX_CHAR`   | 字符串 | `"No."`           | 最终文件名前缀（可设为 `"文件"`、`"序号"` 或空字符串）                         |
| `BASE_SERIAL`   | 整数  | `0`               | 基准常量（新序号 = 基准值 + 反转后序号）                                  |
| `SEPARATORS`    | 列表  | `['.', '、', ' ']` | 序号分隔符（支持添加新分隔符，如 `['.', '、', ' ', '_']`）                 |

## 🚀 使用步骤



1. **下载代码**：将程序代码保存为 `ReSerial.py` 文件

2. **修改配置**：打开文件，根据实际需求修改顶部可配置常量（重点修改 `TARGET_FOLDER` 为你的目标文件夹路径）

3. **运行程序**：

* 打开命令提示符（CMD）或终端

* 切换到代码所在目录（如 `cd H:\Tes`）

* 执行命令：`python ``ReSerial.py`

1. **查看结果**：程序运行后输出重命名日志，目标文件夹中文件已按规则重命名

## 📌 支持的文件格式

程序仅匹配以下格式的文件（无前缀，数字开头 + 分隔符 + 内容）：



* 数字 + 中文顿号：`1、测试.txt`、`8、数据.xlsx`（支持重复序号）

* 数字 + 英文点：`2. 文档.docx`、`9. 报告.pdf`（支持连续分隔符如 `3.. 笔记.txt`）

* 数字 + 空格：`3 图片.png`、`10 视频.mp4`（支持多个空格）

* 多位数序号：`10 资料.zip`、`100 备份.rar`

## 🎯 示例演示

### 场景：



* 配置：`BASE_SERIAL=0`、`SERIAL_PAD=3`、`CONNECTOR=". "`、`PREFIX_CHAR="No."`

* 原文件：`1、测试.txt`、`2. 文档.docx`、`3 图片.png`、`8、数据.xlsx`、`9. 报告.pdf`

### 运行结果：



| 原文件名         | 反转后序号 | 基准累加后序号 | 新文件名              |
| ------------ | ----- | ------- | ----------------- |
| `1、测试.txt`   | 9     | 9       | `No.009. 测试.txt`  |
| `2. 文档.docx` | 8     | 8       | `No.008. 文档.docx` |
| `3 图片.png`   | 3     | 3       | `No.003. 图片.png`  |
| `8、数据.xlsx`  | 2     | 2       | `No.002. 数据.xlsx` |
| `9. 报告.pdf`  | 1     | 1       | `No.001. 报告.pdf`  |

### 重复序号处理示例：



* 原文件：`1、测试.txt`（2 个）、`2. 文档.docx`

* 运行结果：`No.009. 测试.txt`、`No.009. 测试(1).txt`、`No.008. 文档.docx`（自动添加后缀避免覆盖）

## 🔧 常见问题

### 1. 程序提示「目标文件夹不存在」



* 检查 `TARGET_FOLDER` 路径是否正确（Windows 路径需用 `\` 或加 `r` 前缀）

* 示例正确路径：`r"C:\Users\张三\Desktop\测试文件夹"`

### 2. 部分文件未被识别



* 确认文件是否符合「数字开头 + 配置分隔符 + 内容」格式

* 检查 `SEPARATORS` 常量是否包含文件中的分隔符（如文件是 `1-测试.txt`，需在 `SEPARATORS` 中添加 `'-'`）

### 3. 重命名时提示「权限不足」



* 关闭目标文件夹中正在打开的文件

* 以管理员身份运行命令提示符 / 终端后执行程序

### 4. 序号补位不符合预期



* 调整 `SERIAL_PAD` 常量（如需要 2 位补位，设置为 `SERIAL_PAD=2`，序号 1→01）

## 📝 扩展说明

### 添加新分隔符

如需支持 `1-测试.txt`、`2_文档.docx` 格式，修改 `SEPARATORS` 即可：



```
SEPARATORS = \['.', '、', ' ', '-', '\_']  # 新增 '-' 和 '\_' 分隔符
```

### 取消文件名前缀

如需去掉 `No.` 前缀，设置 `PREFIX_CHAR` 为空字符串：



```
PREFIX\_CHAR = ""  # 新文件名将变为「009. 测试.txt」
```

### 修改基准值

如需基准值为 20，设置 `BASE_SERIAL=20`：



* 原序号 9→20+9=29，原序号 8→20+8=28...

## 🚨 注意事项



1. 建议先备份目标文件夹中的文件，避免误操作

2. 程序仅处理文件，不会修改或删除文件夹

3. 若新文件名已存在，会自动添加 `(1)`、`(2)` 后缀，不会覆盖原有文件

4. 运行后请查看控制台输出，确认重命名成功数量和失败原因

> （注：文档部分内容可能由 AI 生成）